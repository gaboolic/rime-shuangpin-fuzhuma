# åŒæ‹¼å¹¶å‡»çš„ä¸€ä¸ªdemo - gaboolic
# https://github.com/gaboolic/rime-shuangpin-fuzhuma
# encoding: utf-8


schema:
  schema_id: flypy_bingji
  name: ä¹±åºå¹¶å‡» + é¹¤å½¢
  version: "0.1"
  author:
    - Functoreality
    - åŒæ‹¼å¹¶å‡»@gaboolic
  description: |
    å¹¶å‡»åŒæ‹¼
  dependencies:
    - luna_pinyin
    - chaizi
    - stroke
    - zrlf
    - emoji
    - easy_en

switches:
  - name: ascii_mode
    states: [ ä¸­æ–‡, è¥¿æ–‡ ]
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
  - name: simplification
    reset: 1
    states: [ æ¼¢å­—, æ±‰å­— ]
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
  - name: ascii_punct
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]

engine:
  processors:
    - ascii_composer
    - chord_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - affix_segmentor@quanpin
    - affix_segmentor@emojis
    - affix_segmentor@verbatim ## not as the last of this list
    - affix_segmentor@soft_capslock
    - affix_segmentor@dbpy_flypy_help
    - affix_segmentor@easy_en_simp
    - affix_segmentor@tex_translator
    - fallback_segmentor
  translators:
    - punct_translator
    - table_translator@custom_phrase
    - reverse_lookup_translator
    - reverse_lookup_translator@reverse_stroke
    - reverse_lookup_translator@reverse_zrlf
    - script_translator
    - script_translator@quanpin
    - table_translator@emojis
    - table_translator@soft_capslock
    - table_translator@dbpy_flypy_help
    - lua_translator@tex_translator
    - lua_translator@func_translator
    - lua_translator@date_translator    # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - table_translator@easy_en_simp ## æ·»åŠ æ³¨é‡Šåï¼šåœç”¨å•è¯è¾“å…¥
  filters:
    - lua_filter@long_word_filter                   # é•¿è¯ä¼˜å…ˆï¼ˆé¡ºåºè¦æ±‚ï¼šé•¿è¯ä¼˜å…ˆ > Emojiï¼‰
    - simplifier@emoji                              # Emoji
    - simplifier@traditionalize                     # ç®€ç¹åˆ‡æ¢
    - uniquifier

# Lua é…ç½®: æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸã€ISO 8601ã€æ—¶é—´æˆ³çš„è§¦å‘å…³é”®å­—
date_translator:
  date: date            # æ—¥æœŸï¼š 2022-11-29
  time: time            # æ—¶é—´ï¼š 18:13
  week: week            # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
  datetime: datetime    # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
  timestamp: timestamp  # æ—¶é—´æˆ³ï¼š 1669716794
  
# Lua é…ç½®ï¼šé•¿è¯ä¼˜å…ˆ
# æå‡ count ä¸ªè¯è¯­ï¼Œæ’å…¥åˆ°ç¬¬ idx ä¸ªä½ç½®ã€‚
# ç¤ºä¾‹ï¼šå°† 2 ä¸ªè¯æ’å…¥åˆ°ç¬¬ 1  ä¸ªå€™é€‰é¡¹ï¼Œè¾“å…¥ æ€»ç®— å¾—åˆ°ã€Œ1æ€»ç®— 2çºµã€
long_word_filter:
  count: 2
  idx: 1

speller:
  alphabet: zyxwvutsrqponmlkjihgfedcba
  initials: zyxwvutsrqponmlkjihgfedcba
  delimiter: " '"
  ## speller aå¼•å¯¼0å£°æ¯
  algebra:
    - derive/^ao(.*)$/AC$1/
    - derive/^an(.*)$/AJ$1/
    - derive/^ai(.*)$/AD$1/

    - derive/^ei(.*)$/AW$1/
    - derive/^er(.*)$/AQ$1/
    - derive/^oo(.*)$/AO$1/
    - derive/^ou(.*)$/AB$1/
    - derive/^ee(.*)$/AE$1/
    - derive/^en(.*)$/AF$1/

    - xlit/QWERTYUIOPASDFGHJKLZXCVBNM/qwertyuiopasdfghjklzxcvbnm/

    - derive|^(.+)[[](\w)(\w)$|$1| # çº¯åŒæ‹¼çš„æƒ…å†µ
    - derive|^(.+)[[](\w)(\w)$|$1$2| # åŒæ‹¼+ä¸€ä½è¾…åŠ©ç çš„æƒ…å†µ
    - abbrev|^(.+)[[](\w)(\w)$|$1$2$3| # åŒæ‹¼+2ä½è¾…åŠ©ç çš„æƒ…å†µï¼Œabbrevç±»å‹ä¸å¯ä»¥æ•´å¥å†…è¾“å…¥2ä½è¾…åŠ©ç ï¼Œå¿…é¡»åŠ oæˆ–/
    - derive|^(.+)[[](\w)(\w)$|$1$2$3o| # æ•´å¥æ¨¡å¼ä¸‹ï¼Œè¾“å…¥syffo å‡ºå•å­— å¢å¼ºå•å­—æ€§èƒ½
    - derive|^(.+)[[](\w)(\w)$|$1$2$3/| # æ•´å¥æ¨¡å¼ä¸‹ï¼Œè¾“å…¥syff/ å‡ºå•å­— å¢å¼ºå•å­—æ€§èƒ½
    # - derive/[[]// ## å–æ¶ˆæ³¨é‡Šåï¼šç›´æ¥å¼•å¯¼2ä½è¾…åŠ©ç ï¼›å¦åˆ™åªèƒ½å¼•å¯¼1ä½è¾…åŠ©ç æˆ–è€…2ä½è¾…åŠ©ç åŠ /

chord_composer:
  # å­—æ¯è¡¨ï¼ŒåŒ…å«ç”¨å¹¶å‡»æŒ‰é”®
  # å‡»é”®ä¸€å¾‹ä»¥å­—æ¯è¡¨é¡ºåºæ’åˆ—
  alphabet: "aqzswxdecfrvgtbhynjumki,lo.;p',./"
  algebra:
    # - "xform/^,$/,/"
    # - "xform/^\.$/./"
    # å®šä¹‰å·¦æ‰‹
    - xform/^sf(?![å·¦å³])/uå·¦/
    - xform/^df(?![å·¦å³])/vå·¦/
    - xform/^se(?![å·¦å³])/lå·¦/
    - xform/^af(?![å·¦å³])/iå·¦/
    - xform/^we(?![å·¦å³])/kå·¦/
    - xform/^wf(?![å·¦å³])/cå·¦/
    - xform/^wg(?![å·¦å³])/på·¦/
    - xform/^sd(?![å·¦å³])/så·¦/
    - xform/^ef(?![å·¦å³])/få·¦/

    - xform/^f(?![å·¦å³])/yå·¦/
    - xform/^s(?![å·¦å³])/jå·¦/
    - xform/^e(?![å·¦å³])/bå·¦/
    - xform/^v(?![å·¦å³])/hå·¦/
    - xform/^c(?![å·¦å³])/må·¦/
    - xform/^b(?![å·¦å³])/nå·¦/

    # å®é™…ç”¨ä¸åˆ°å·¦æ‰‹e o
    - xform/^er(?![å·¦å³])/eå·¦/
    - xform/^qw(?![å·¦å³])/oå·¦/

    # - xform/^d(?![å·¦å³])/då·¦/
    # - xform/^x(?![å·¦å³])/xå·¦/
    # - xform/^t(?![å·¦å³])/tå·¦/
    # - xform/^g(?![å·¦å³])/gå·¦/
    # - xform/^z(?![å·¦å³])/zå·¦/
    # - xform/^w(?![å·¦å³])/wå·¦/
    # - xform/^q(?![å·¦å³])/qå·¦/
    # - xform/^r(?![å·¦å³])/rå·¦/

    # å®šä¹‰å³æ‰‹
    - xform/uo(?![å·¦å³])$/zå³/
    - xform/ho(?![å·¦å³])$/cå³/
    - xform/ji(?![å·¦å³])$/må³/
    - xform/op(?![å·¦å³])$/så³/
    - xform/kl(?![å·¦å³])$/wå³/
    - xform/nk(?![å·¦å³])$/gå³/
    - xform/ui(?![å·¦å³])$/vå³/
    - xform/ni(?![å·¦å³])$/bå³/
    - xform/jo(?![å·¦å³])$/rå³/
    - xform/io(?![å·¦å³])$/nå³/
    - xform/il(?![å·¦å³])$/qå³/
    - xform/hi(?![å·¦å³])$/xå³/
    - xform/jl(?![å·¦å³])$/tå³/
    - xform/kl(?![å·¦å³])$/qå³/ #er
    - xform/hl(?![å·¦å³])$/lå³/
    - xform/jk(?![å·¦å³])$/kå³/

    - xform/n(?![å·¦å³])$/hå³/
    - xform/k(?![å·¦å³])$/eå³/
    - xform/h(?![å·¦å³])$/aå³/
    - xform/l(?![å·¦å³])$/då³/
    - xform/m(?![å·¦å³])$/få³/

    # - xform/u(?![å·¦å³])$/uå³/
    # - xform/o(?![å·¦å³])$/oå³/
    # - xform/i(?![å·¦å³])$/iå³/
    # - xform/p(?![å·¦å³])$/på³/
    # - xform/y(?![å·¦å³])$/yå³/
    # - xform/j(?![å·¦å³])$/jå³/

   
  # å¹¶å‡»å®Œæˆåå¥—ç”¨å¼æ ·
  output_format:
    - "xform/^(.*)å·¦/$1/"
    - "xform/^(.*)å³$/$1/"
    - "xform/^(.*)å·¦(.*)å³$/$1$2/"
    - xlit/QWERTYUIOPASDFGHJKLZXCVBNM/qwertyuiopasdfghjklzxcvbnm/

 # å¹¶å‡»è¿‡ç¨‹ä¸­å¥—ç”¨å¼æ ·  
  prompt_format:
    # åŠ æ–¹æ‹¬å·
    # - "xform/^(.*)$/[$1]/" 

translator:
  dictionary: flypy_flypy.extended
  prism: flypy_bingji
  enable_completion: false
  spelling_hints: 1
  comment_format:
    - "xform/(^|[ '])[^[]+[[]/$1/" ## ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†

  enable_user_dict: false # æ˜¯å¦å¼€å¯è‡ªåŠ¨è°ƒé¢‘ 
  # preedit_format:
    # - "xform/((^|[ '])[bpmfdtnljqx])n/$1iao/"
    # - "xform/((^|[ '])\\w)g/$1eng/"
    # - "xform/((^|[ '])\\w)q/$1iu/"
    # - "xform/((^|[ '])\\w)w/$1ei/"
    # - "xform/((^|[ '])[dtnlgkhjqxyvuirzcs])r/$1uan/"
    # - "xform/((^|[ '])\\w)t/$1ve/"
    # - "xform/((^|[ '])\\w)y/$1un/"
    # - "xform/((^|[ '])[dtnlgkhvuirzcs])o/$1uo/"
    # - "xform/((^|[ '])\\w)p/$1ie/"
    # - "xform/((^|[ '])[jqx])s/$1iong/"
    # - "xform/((^|[ '])\\w)s/$1ong/"
    # - "xform/((^|[ '])\\w)d/$1ai/"
    # - "xform/((^|[ '])\\w)f/$1en/"
    # - "xform/((^|[ '])\\w)h/$1ang/"
    # - "xform/((^|[ '])\\w)j/$1an/"
    # - "xform/((^|[ '])[gkhvuirzcs])k/$1uai/"
    # - "xform/((^|[ '])\\w)k/$1ing/"
    # - "xform/((^|[ '])[jqxnl])l/$1iang/"
    # - "xform/((^|[ '])\\w)l/$1uang/"
    # - "xform/((^|[ '])\\w)z/$1ou/"
    # - "xform/((^|[ '])[gkhvuirzcs])x/$1ua/"
    # - "xform/((^|[ '])\\w)x/$1ia/"
    # - "xform/((^|[ '])\\w)c/$1ao/"
    # - "xform/((^|[ '])[dtgkhvuirzcs])v/$1ui/"
    # - "xform/((^|[ '])\\w)b/$1in/"
    # - "xform/((^|[ '])\\w)m/$1ian/"
    # - "xform/(^|[ '])([aoe])\\2(\\w)/$1$2$3/"
    # - "xform/(^|[ '])v/$1zh/"
    # - "xform/(^|[ '])i/$1ch/"
    # - "xform/(^|[ '])u/$1sh/"
    # - "xform/((^|[ '])[jqxy])v/$1u/"
    # - "xform/((^|[ '])[nl])v/$1Ã¼/"

custom_phrase:
  dictionary: ""
  user_dict: custom_phrase_bj
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1




reverse_lookup:
  dictionary: chaizi_flypy # stroke
  enable_completion: true
  prefix: "ab"
  suffix: "'"
  tips: ã€”éƒ¨ä»¶ç»„å­—ã€• # ã€”ç­†ç•«ã€•
  preedit_format:
    # - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/


reverse_zrlf:
  tag: reverse_zrlf
  dictionary: zrlf # stroke
  enable_completion: true
  prefix: "olf"
  suffix: "'"
  tips: ã€”è‡ªç„¶å…©åˆ†ã€•
  preedit_format:
    # - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/

reverse_stroke:
  tag: reverse_stroke
  dictionary: stroke # stroke
  enable_completion: true
  prefix: "ob"
  suffix: "'"
  tips: ã€”ç­†ç•«ã€• # ã€”ç­†ç•«ã€•
  preedit_format:
    - xlit/hspnz/ä¸€ä¸¨ä¸¿ä¸¶ä¹™/

# Emoji
emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false  # åœ¨ corrector.lua åŠåæŸ¥ä¸­ï¼Œemoji è¿”å›ç©ºæ³¨é‡Š


# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json  # s2t.json | s2hk.json | s2tw.json | s2twp.json
  tips: none               # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  tags: [ abc, number, gregorian_to_lunar ]  # é™åˆ¶åœ¨å¯¹åº” tagï¼Œä¸å¯¹å…¶ä»–å¦‚åæŸ¥çš„å†…å®¹åšç®€ç¹è½¬æ¢
  
# æ ‡ç‚¹ç¬¦å·
# punctuator ä¸‹é¢æœ‰ä¸‰ä¸ªå­é¡¹ï¼š
#   full_shape å…¨è§’æ ‡ç‚¹æ˜ å°„
#   half_shape åŠè§’æ ‡ç‚¹æ˜ å°„
#   symbols    Rime çš„é¢„è®¾é…ç½®æ˜¯ä»¥ '/' å‰ç¼€å¼€å¤´è¾“å‡ºä¸€ç³»åˆ—å­—ç¬¦ï¼Œè‡ªå®šä¹‰çš„ symbols_caps_v.yaml ä¿®æ”¹æˆäº† 'V' å¼€å¤´ã€‚
punctuator:
  full_shape:
    __include: default:/punctuator/full_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  half_shape:
    __include: default:/punctuator/half_shape  # ä» default.yaml å¯¼å…¥é…ç½®
  symbols:
    __include: symbols_caps_v:/symbols         # ä» symbols_caps_v.yaml å¯¼å…¥é…ç½®

key_binder:
  import_preset: default
  bindings:
    #- { when: composing, accept: Tab, send: '[' } ## å–æ¶ˆæ³¨é‡Šåï¼štabå¼•å¯¼è¾…åŠ©ç 
    - { when: composing, accept: Control+m, send: Return }
    - { when: composing, accept: Control+w, send: Control+BackSpace }
    - { when: has_menu, accept: semicolon, send: 2 }
    # - { when: has_menu, accept: slash, send: 3 } # ç”¨/è¿›è¡Œé€‰3
    - { when: composing, accept: Control+i, send: Shift+Right }
    - { when: composing, accept: Control+o, send: Shift+Left }
    ## å¯¹ä»¥ä¸‹4è¡Œå–æ¶ˆæ³¨é‡Šåï¼šå¯ç”¨å…‰æ ‡å›é€€è‡³ç‰¹å®šéŸ³èŠ‚åã€è¡¥å……è¾…åŠ©ç çš„åŠŸèƒ½
    ## ï¼ˆè‡ªç„¶ç ç­‰å…¶ä»–åŒæ‹¼ç”¨æˆ·è¯·åœ¨ pinyin_switch.yaml ä¸­è®¾ç½®ï¼‰
    #- { when: composing, accept: Control+1, send_sequence: '{Home}{Shift+Right}[' }
    #- { when: composing, accept: Control+2, send_sequence: '{Home}{Shift+Right}{Shift+Right}[' }
    #- { when: composing, accept: Control+3, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}[' }
    #- { when: composing, accept: Control+4, send_sequence: '{Home}{Shift+Right}{Shift+Right}{Shift+Right}{Shift+Right}[' }

recognizer:
  # import_preset: default
  patterns:
    uppercase: "^[A-Z].*$"
    punct: '^/[015-9A-Za-z]+$' ## use "/er" instead of "/2"
    ## associate schemes: 
    # reverse_lookup: "^ab[a-z]*'?$" # "[[]b[a-z]*'?$"
    # reverse_stroke: "^ob[A-Za-z]*$"
    # reverse_zrlf: "^olf[A-Za-z]*$"
    # quanpin: "^ap[a-z]*'?$"
    # emojis: "^ae[a-z]*'?$" # "^ae.*$" 
    # verbatim: "^as.*$"
    # soft_capslock: "^au.*$"
    # dbpy_flypy_help: "^ac.*$"
    # easy_en_simp: "^aw[a-z]*"
    # tex_translator: "^al(.*)$"
    # func_translator: "^af(.*)$"

menu:
  page_size: 8

quanpin:
  tag: quanpin
  dictionary: luna_pinyin
  prism: luna_pinyin
  enable_completion: true
  prefix: "ap"
  suffix: "'"
  tips: "å…¨æ‹¼"
emojis:
  tag: emojis
  dictionary: emoji
  enable_completion: true
  prefix: "ae"
  suffix: "'"
  tips: " Emoji"
verbatim:
  tag: verbatim ## english; ascii
  prefix: "as"
  tips: "cii"
soft_capslock:
  dictionary: ""
  user_dict: uppercase
  tag: soft_capslock
  prefix: "au"
  tips: "ä¸´æ—¶å¤§å†™"
  db_class: stabledb
  enable_completion: false
  enable_sentence: true
  initial_quality: 1
dbpy_flypy_help:
  dictionary: ""
  user_dict: dbpy_flypy_help
  tag: dbpy_flypy_help
  prefix: "ac"
  tips: "å°é¹¤åŒæ‹¼æŸ¥é”®"
  db_class: stabledb
  enable_completion: true
  enable_sentence: false
  initial_quality: 1
easy_en_simp:
  tag: easy_en_simp
  dictionary: easy_en
  enable_completion: true
  enable_sentence: false
  prefix: "aw"
  # suffix: "'"
  tips: "è‹±æ–‡å•è¯ï¼ˆå¯å»å…ƒéŸ³ï¼‰"
  spelling_hints: 9
  comment_format:
    - xform/^.+$//
tex_translator:
  tag: tex_translator
  prefix: "al"
  tips: " TeX å…¬å¼"

